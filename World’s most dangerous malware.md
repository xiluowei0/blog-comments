# 世界上最危险的恶意软件 Emotet

[toc]

## 背景与发现

​		说起恶意软件，我想大多数经常使用电脑的人对此丝毫不陌生，我们或多或少都在平时使用电脑时遇到过，可能是各种类型的，当然人们可能对其感知不强烈，因为大多数都会被电脑上的杀毒软件直接扼杀在摇篮里了，不会显现出来，如何真的显现了，对于普通用户可能也只有认栽了。那么说起来什么是恶意软件呢？恶意软件是不同类型的恶意程式码的一个统称。恶意软件可用于破坏正常的电脑功能，窃取数据，获得未经授权的访问，或形成僵尸网络以发起有组织的攻击；恶意软件包括任何有损用户利益的软件。恶意软件不仅会影响受感染的电脑或设备，还可能会影响与受感染设备通信的其他设备。恶意软件涵盖从最简单的电脑蠕虫和木马程序，到最复杂的电脑病毒等，都包括在内。恶意软件、病毒和恶意代码相关但不相同，因此只用一种防病毒软件或反恶意软件可能无法抵挡所有威胁。它们可能会出现在台式电脑、笔记本电脑和移动设备上。根据设备所用操作系统的不同（Windows、Android、iOS 或 Apple MacOS），恶意软件可能还会以不同方式发动攻击和呈现出来。世界上不存在绝对安全的设备。无论是专业设备还是个人设备，采取恶意软件防护措施通常都是有用的。

​		说回Emotet，Emotet 银行木马于 2014 年首次被安全研究人员发现。Emotet 最初被设计为一种银行恶意软件，它试图潜入您的计算机并窃取敏感和私人信息。该软件的更高版本增加了垃圾邮件和恶意软件递送服务——包括其他银行木马。

​		Emotet 使用的功能有助于软件逃避某些反恶意软件产品的检测。Emotet 使用类似蠕虫的功能来帮助传播到其他连接的计算机，这有助于分发恶意软件。这一功能使国土安全部得出结论，Emotet 是最昂贵和最具破坏性的恶意软件之一，影响政府和私营部门、个人和组织，每次清理事件的成本高达 100 万美元。Emotet 是一种木马，主要通过垃圾邮件 ( malspam ) 传播。感染可能通过恶意脚本、启用宏的文档文件或恶意链接到达。Emotet 电子邮件可能包含旨在看起来像合法电子邮件的熟悉品牌。Emotet 可能会尝试通过使用有关“您的发票”、“付款详细信息”或可能来自知名包裹公司的即将发货的诱人语言来说服用户单击恶意文件。

## Emotet是如何传播发展的？

​		Emotet 的主要分发方法是通过恶意垃圾邮件。Emotet 会搜索您的联系人列表并将其发送给您的朋友、家人、同事和客户。由于这些电子邮件来自您被劫持的电子邮件帐户，因此这些电子邮件看起来不像垃圾邮件，而且收件人感到安全，更倾向于点击错误的 URL 并下载受感染的文件。EMOTET 小组还设法将电子邮件作为攻击媒介提升到了一个新的水平。通过完全自动化的过程，EMOTET 恶意软件通过受感染的电子邮件附件传送到受害者的计算机。各种不同的诱饵被用来诱骗毫无戒心的用户打开这些恶意附件。所有这些电子邮件都包含恶意 Word 文档，这些文档要么附加到电子邮件本身，要么可通过单击电子邮件本身的链接进行下载。一旦用户打开其中一个文档，系统就会提示他们“启用宏”，以便隐藏在 Word 文件中的恶意代码可以运行并在受害者的计算机上安装 EMOTET 恶意软件。

​		如果存在连接的网络，Emotet 会使用常用密码列表进行传播，并以暴力攻击方式猜测其进入其他连接系统的方式。如果最重要的人力资源服务器的密码只是“密码”，那么 Emotet 很可能会找到它的方式。

### Emotet发展史

Emotet 恶意软件第一个版本出现于2014年，通过拦截互联网流量来窃取银行凭证信息。当时，Emotet恶意软件的攻击目标是德国和奥地利的银行。

很快，第二个版本出现了，并增加了一些额外的模块，比如转账、垃圾邮件、DDoS和地址簿窃取模块。Emotet 第三版出现于2015年，主要升级了反绕过功能，并将瑞士的银行加入了潜在攻击目标列表。

2016年12月，Emotet第4个版本出现，修改了攻击向量。第4版最初主要依赖RIG 4.0漏洞利用套件来进入受害者计算机，随后转向垃圾邮件。之后，第4版从使用自己的银行模块转向在受感染的机器上释放其他的木马。

根据使用的模块不同，Emotet 恶意软件可以执行大量的恶意活动。病毒的大多数版本包括一个垃圾邮件模块，可以通过从受感染的机器来发送恶意邮件来传播恶意软件。另一个非常常见的模块是凭证窃取模块，允许Emotet 来从web浏览器和邮件客户端窃取敏感信息。

从2017年开始，Emotet木马中出现了传播器模块，可以用来感染通过本地网络互联的所有机器。此外，病毒还实现了地址簿窃取模块，分析了邮件发送者和接收者之间的关系，并用收集来的信息来增强随后从用户计算机发起的攻击活动的有效性，用个人定制化的垃圾邮件来攻击朋友、家庭成员和大学同学。

Emotet 恶意软件通过模块的使用和不同的反绕过函数提供了许多灵活的功能，还实现了驻留。为确保恶意软件在受感染的机器中，恶意软件会注入运行的进程中，一般是Explorer.exe。此外，恶意软件还用计划任务和修改注册表的方法。

## Emotet的危害

​		美国国土安全局认为，Emotet 是一种造成代价特别高的软件，具有巨大的破坏力。每次事件的清理费用估计约为一百万美元。因此，联邦信息安全办公室 (FIS) 的负责人 Arne Schönbohm 将 Emotet 称为“恶意软件之王”。毫无疑问，Emotet 是史上最复杂、最危险的恶意软件程序之一。该恶意软件是多态的，这意味着，每次访问它时，其代码都会稍有变化。这使防病毒软件很难识别该恶意软件，因为许多防病毒程序都执行基于签名的搜索。2020 年 2 月，来自 Binary Search 的安全研究人员发现，Emotet 现在也会攻击 **Wi-Fi 网络**。如果受感染的设备接入无线网络，Emotet 会扫描附近的所有无线网络。然后，恶意软件使用密码列表尝试访问网络，从而感染其他设备。

​		网络犯罪分子喜欢利用人们的恐惧心理。因此，毫不意外，自 2019 年 12 月以来在世界范围内传播的**新冠病毒**恐惧也被 Emotet 所利用。该木马病毒背后的网络犯罪分子经常伪造电子邮件，声称可以提供有关新冠疫情的信息并提供公众教育。如果您在收件箱中找到这样的电子邮件，请特别注意电子邮件中的任何附件或链接！

​		Emotet会窃取受害者本地的邮件联系人列表，并回传至CC服务器，随即利用这些邮件联系人进一步讲恶意邮件分发给其他联系人，造成蠕虫式的传播，导致很多受害企业内部大量员工被攻击。有勒索团伙会利用Emotet进一步下发勒索木马，美国水务局曾经因此被Ryuk勒索攻击，因此此次事件中相关失陷的企业也很有可能遭受勒索、窃密等后续的攻击，潜在的危害巨大。窃取受害者主机上的系统、文件、邮件等敏感信息，造成内部信息泄露。

## 如何防治

以下是一些可以采取的防治措施：

1. 使用 Microsoft Windows 的最新补丁使您的计算机/端点保持最新。TrickBot 通常作为辅助 Emotet 有效负载交付，我们知道其依赖于 Windows EternalBlue漏洞来完成其肮脏的工作，因此请在网络犯罪分子利用它之前修补该漏洞。
2. 不要下载可疑的附件或点击可疑的链接。如果您避开那些可疑的电子邮件，Emotet 就无法在您的系统或网络上获得最初的立足点。
3. 提醒自己创建强密码，当您使用它时，请开启使用双重身份验证。
4. 更新网络安全工具（防病毒和操作系统），可以使用包含多层保护的强大网络安全程序，即多种计算机病毒杀毒软件相结合来保护自己免受 Emotet 的侵害。

​		如果您怀疑自己已经被 Emotet 感染，请不要惊慌。如果您的计算机已连接到网络，请立即将其隔离。隔离后，继续修补和清理受感染的系统。但你还没有完成。由于 Emotet 在您的网络中传播的方式，干净的计算机在重新插入受感染的网络时可能会被重新感染。逐一清理网络上的每台计算机，这是一个乏味的过程。



